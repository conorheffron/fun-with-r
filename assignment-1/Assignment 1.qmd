---
title: "Assignment 1"
author: "Conor Heffron 23211267"
format: 
  html:
   embed-resources: true
   code-fold: true
  pdf: default
---

# Task 1: Manipulation

## 1. Load dataset

- Load the dataset EurostatCrime2021.xlsx. Notice that the data starts in row 6, with row 7 containing the variable names, and that the missing values are represented by ":". [Note: do not modify the original file EurostatCrime2021.xlsx directly (by opening it with Excel, for example) as we need to be able to render your .Qmd file and reproduce your final document
using the original dataset.

```{r}
library(readxl)
# EurostatCrime2021 <- read_excel("/Users/conorheffron/Google Drive/UCD/MSc in AI for Medicine and Medical Research/Courses/Trimester 1/STAT30340-Data Programming with R/EurostatCrime2021.xlsx", sheet = "Sheet 1", col_types = c("text", "numeric", "numeric", "numeric", "numeric", "numeric", "numeric", "numeric", "numeric", "numeric", "numeric", "numeric", "numeric",  "numeric", "numeric", "numeric", "numeric", "numeric"), skip = 5)



EurostatCrime2021 <- read_excel("/Users/conorheffron/Google Drive/UCD/MSc in AI for Medicine and Medical Research/Courses/Trimester 1/STAT30340-Data Programming with R/EurostatCrime2021.xlsx", sheet = "Sheet 1", skip = 5)
```

## 2. Size / Dimensions of data set

- What is the size (number of rows and columns) and the structure of this dataset?

- Answer: 41 observations / records of 18 variables / columns

```{r}
dim(EurostatCrime2021)
```

## 3. Remove fraud columns X2

- Remove the columns Fraud and Money laundering (they contain no data).

```{r}
library(dplyr)
df <- select(EurostatCrime2021, -Fraud, -"Money laundering")
```

## 4. Remove theft/burglary related columns X2

- For some countries Theft includes also Theft of a motorized vehicle or parts thereof, Burglary, and Burglary of private residential premises, in others they are recorded separately. To compare different countries, remove the columns involving theft and burglary:
  • Theft,
  • Theft of a motorized vehicle or parts thereof,
  • Burglary,
  • Burglary of private residential premises

```{r}
df2 <- subset(select(df, -Theft, -"Theft of a motorized vehicle or parts thereof", -Burglary, -"Burglary of private residential premises"))
```

## 5. Add a column

- Add a column containing the overall record of offences for each country (per hundred thousand inhabitants) [Hint: there is a function in base R that allow you to do this].

```{r}
df2_num <- select(df2, -Country)
df2[colnames(df2_num)] <- sapply(df2[colnames(df2_num)], as.numeric)


df2$offences <- rowSums(select(df2, -Country))
```

## 6. List countries with missing data

- Work with the dataset you just created, and write some code to list the countries that contain
any missing data.

```{r}
print(df2[which.max(df2$offences),])


countries<-list()
for(i in 1:nrow(df2)) { 
 if(any(is.na(df2[i,]))) {
  countries <- append(countries, df2[[i,"Country"]])
 }
}
print(length(countries))
print(countries)
```

## 7. Remove the countries with missing data.

```{r}
df2 <- na.omit(df2)
```

## 8. How many observations and variables are in this new dataset?

```{r}
dim(df2)
```

# Task 2: Analysis

- Work with the dataset produced at the end of Task 1.

## 1. Which country has the highest overall record of offences in 2021 (per hundred thousand inhab- itants)? To get full marks you must also provide the R code that returns that country name only. [1]

```{r}
print(df2[which.max(df2$offences),"Country"])
```

## 2. Produce a table showing the countries and the proportion of the overall crimes due to acts against computer system, sort the rows in ascending order of proportions, and display only the first three decimal digits. [2]

```{r}
# country
# (crimes due to acts against computer ) / offences * 100

df5 <- select(df2, Country, offences, "Acts against computer systems")
df5$proportion <- (df2$"Acts against computer systems" / df2$offences) * 100

df5[,'proportion']=round(df5[,'proportion'],3)

df6 <- df5[order(as.integer(df5$proportion),decreasing = FALSE), ]
```

## 3. Create a plot displaying the relationship between robbery and unlawful acts involving controlled drugs or precursors. Make the plot “nice” i.e., show country names, change size of the plot, change axis labels, etc.

```{r}
# plot.window(xlim = c(0, 120), ylim = c(0, 510))
# plot(df2)
# plot(y=df2$"Robbery", x=df2$"Unlawful acts involving controlled drugs or precursors", type="p", main = "The relationship between robbery and unlawful acts (controlled drugs...)", xlab = "Unlawful acts involving controlled drugs or precursors", ylab = "Robbery")
# points(df2$Country, y= Null, typer = "p")
# text(df2$"Robbery", df2$"Unlawful acts involving controlled drugs or precursors", labels = df2$Country)

library(ggplot2)
# d = data.frame(x=runif(50),y=runif(50),z=runif(50))
colnames(df2) <- gsub(" ", "_", colnames(df2))
df2 |>
  ggplot(mapping = aes(x = Unlawful_acts_involving_controlled_drugs_or_precursors, y = Robbery)) +
  geom_point(aes(colour = Country)) +
  labs(x = "Unlawful acts involving controlled drugs or precursors")
# dplyr group by country and then plot with above pts
```

# Task 3: Creativity

- Do something interesting with these data! Create two plots showing something we have not discov- ered above already and outline your findings. For this Task you can decide if you want to use the original dataset from Task 1 Question 1 or the modified one. [4]

```{r}

```

